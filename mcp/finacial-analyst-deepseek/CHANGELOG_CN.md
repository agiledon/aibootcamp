# 中国A股市场支持更新日志

## 更新概述

本项目已从支持美股市场（使用yfinance）更新为支持中国A股市场（使用akshare），以解决国内网络环境下访问美股数据的API限制问题。

## 主要变更

### 1. 依赖库更新
- ✅ 新增 `akshare` 库（1.17.63版本）
- ✅ 移除对 `yfinance` 的依赖
- ✅ akshare无需API密钥，访问稳定

### 2. 代码文件修改

#### `finance_crew.py`
**变更内容：**
- 导入库：`import yfinance as yf` → `import akshare as ak`
- 数据模型：
  - `symbols` → `stock_codes`（股票代码，如600519）
  - `symbols` → `stock_names`（股票名称，如贵州茅台）
  - 时间周期调整为中文描述
- Agent角色和任务描述完全本地化为中文
- 更新股票代码规则说明（沪深市场）

#### `server.py`
**变更内容：**
- 工具描述完全本地化为中文
- 示例查询更新为中国A股示例
- 支持的股票列表更新

### 3. 新增文件

#### `maotai_analysis_example.py`
- ✨ 完整的贵州茅台股票分析示例
- 展示如何使用akshare获取A股数据
- 包含4个可视化图表
- 完整的中文注释和说明

#### `CN_STOCK_GUIDE.md`
- 📚 中国A股分析完整指南
- 常用股票代码列表
- akshare使用方法详解
- 中英文双语示例查询

#### `CHANGELOG_CN.md`
- 📝 本次更新的完整变更日志

### 4. 文档更新

#### `README.md`
**英文部分：**
- 添加中国A股支持声明
- 更新Features列表
- 更新示例查询为A股示例
- 添加快速参考股票代码列表

**中文部分：**
- 添加中国A股支持声明
- 更新功能特性列表
- 更新示例查询
- 更新主要参考资料（akshare替代yfinance）

## 支持的市场

### 🇨🇳 中国A股市场
- **沪市主板**：600xxx, 601xxx, 603xxx, 605xxx
- **深市主板**：000xxx
- **中小板**：002xxx
- **创业板**：300xxx
- **科创板**：688xxx

## 数据对比

| 特性 | yfinance (美股) | akshare (A股) |
|------|-----------------|---------------|
| API密钥 | 不需要 | 不需要 |
| 网络要求 | 需要访问Yahoo Finance | 访问国内数据源 |
| 数据延迟 | 实时 | 15-20分钟 |
| 支持市场 | 美股、港股等 | 中国A股 |
| 稳定性 | 国内可能受限 | 国内访问稳定 |

## 使用示例

### 分析贵州茅台
```bash
# 运行示例代码
uv run maotai_analysis_example.py

# 使用CrewAI (修改查询)
uv run finance_crew.py
```

### 示例查询
```python
# 基本分析
"分析贵州茅台(600519)过去一年的股票表现"

# 股票对比
"对比招商银行和工商银行过去一年的表现"

# 交易量分析
"分析比亚迪过去3个月的交易量变化"

# 价格趋势
"显示宁德时代过去半年的股价走势"
```

## 常用股票代码

| 股票名称 | 股票代码 | 行业 |
|---------|---------|------|
| 贵州茅台 | 600519 | 白酒 |
| 工商银行 | 601398 | 银行 |
| 招商银行 | 600036 | 银行 |
| 比亚迪   | 002594 | 新能源汽车 |
| 宁德时代 | 300750 | 新能源电池 |

## 测试结果

✅ **已验证功能：**
- ✅ akshare数据获取正常
- ✅ 贵州茅台分析示例运行成功
- ✅ 生成4个可视化图表
- ✅ 中文标签和字体正确显示
- ✅ 所有统计指标计算正确

**测试输出示例：**
```
=== 贵州茅台(600519) 股票分析报告 ===
数据点数量: 365
开始日期: 2024-04-03
结束日期: 2025-09-30

=== 价格表现 ===
起始价格: ¥1632.75
当前价格: ¥1443.99
价格变化: ¥-188.76 (-11.56%)

=== 交易统计 ===
平均成交量: 34,152 手
累计成交额: ¥18887.69 亿元

=== 波动性分析 ===
年化波动率: 25.50%
总收益率: -11.56%
```

## 后续工作

- [ ] 支持港股市场
- [ ] 添加更多技术指标
- [ ] 支持股票筛选和排名
- [ ] 添加实时行情功能

## 参考资料

- [akshare官方文档](https://akshare.akfamily.xyz/)
- [akshare GitHub](https://github.com/akfamily/akshare)
- [CN_STOCK_GUIDE.md](./CN_STOCK_GUIDE.md) - 详细使用指南

---

**更新日期**: 2025-10-08  
**更新作者**: Zhang Yi (@agiledon)

